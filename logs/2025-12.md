# 2025-12 作業ログ

## 2025-12-18 作業概要

### 実施内容

1. **Windows環境でのexcel-vba-expertスキル設定**
   - WSL側のスキルを確認（`\\wsl.localhost\Ubuntu-22.04\home\shostako\.claude\skills\excel-vba-expert\`）
   - Windows側のスキル（`C:\Users\shost\.claude\skills\excel-vba-expert\SKILL.md`）をWindows用パスに修正
   - 保存先: `/home/shostako/...` → `C:\Users\shost\ClaudeCode\excel-auto\src\`
   - 変換コマンド: `./scripts/bas2sjis` → `.\scripts\bas2sjis.ps1`

2. **VBAマクロレビュー・修正（9モジュール）**
   - mCommon.bas - 問題なし、そのまま採用
   - m完成品フィルター.bas - 修正
   - m項目フィルター.bas - 修正
   - m項目削除.bas - 修正
   - m項目追加.bas - 修正
   - m小部品フィルター.bas - 修正
   - m側板フィルター.bas - 修正
   - m日付表示.bas - 修正
   - mフィルター解除.bas - 修正

### 共通の修正内容

- **元の設定を保存** → 元の値で復元（固定値Trueではなく）
- **Cleanupラベル追加** → 設定復元コードを一箇所に集約
- **FindTableByPatternのNothingチェック追加**
- **AutoFilterオブジェクトの存在チェック追加**
- **エラー情報の詳細化**（errNum, errDesc変数使用）

### 技術的な学び

- Git Bash環境でPowerShellスクリプトを実行: `powershell.exe -File script.ps1`
- Shift-JISファイルの読み込み: `iconv -f SHIFT-JIS -t UTF-8 "file.bas"`
- WSLファイルへのアクセス: `\\wsl.localhost\ディストリビューション名\...`

### 出力ファイル

```
src/ (UTF-8)
├── mCommon.bas
├── m完成品フィルター.bas
├── m項目フィルター.bas
├── m項目削除.bas
├── m項目追加.bas
├── m小部品フィルター.bas
├── m側板フィルター.bas
├── m日付表示.bas
└── mフィルター解除.bas

macros/ (Shift-JIS) - Excelインポート用
└── 同上9ファイル
```

---

## 2025-12-18 追加作業

### 実施内容

1. **プロジェクト名変更**
   - `excel-auto` → `excel-dev` に統一
   - CLAUDE.md、PROGRESS.md を修正

2. **Mondayエージェント設定**
   - 場所: `~/.claude/agents/monday.md`（ユーザーレベル設定）
   - 25歳のドライなITアシスタント、タメ口・皮肉を交えた対話スタイル
   - プロジェクト横断で有効

3. **Claude Code設定の更新**
   - `.claude/settings.json` - hooks設定を新フォーマットに移行
   - `.mcp.json` - playwright MCP設定にcmdラッパー追加（Windows対応）

### 備考

- Monday設定はgitリポジトリ外（ユーザーレベル）のため、コミット対象外
- GitHub連携を実施予定

---

## 2025-12-18 Claude Code環境改善

### 問題

- Plan modeの切り替えショートカットが`Shift+Tab`ではなく`Alt+M`だった
- 操作性が悪い

### 調査結果

- **原因**: npm版とnative版でキーバインドが異なる
- **npm-global版**: `Alt+M`（Windows固有のワークアラウンド）
- **native installer版 (v2.0.31以降)**: `Shift+Tab`

### 参照したGitHub Issues

- [#3368](https://github.com/anthropics/claude-code/issues/3368) - Shift+Tab not working on Windows (47+👍)
- [#5885](https://github.com/anthropics/claude-code/issues/5885) - Mode switching shortcut inconsistency
- CHANGELOG.md - v2.0.31で修正記載

### 解決策

1. npm版をアンインストール: `npm uninstall -g @anthropic-ai/claude-code`
2. https://claude.ai/download からnative installerをダウンロード・インストール
3. `claude doctor`で`native`になっていることを確認

### 結果

- native版への切り替えで`Shift+Tab`が正常に動作
- 設定ディレクトリ（`~/.claude/`、プロジェクトの`.claude/`）は影響なし

### 教訓

- Windows環境のClaude Codeはインストール方法でキーバインドが異なる
- 公式ドキュメントに明記されていないため、Issue/CHANGELOGを調べる必要がある
