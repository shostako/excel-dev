# 2025-12 作業ログ

## 2025-12-18 作業概要

### 実施内容

1. **Windows環境でのexcel-vba-expertスキル設定**
   - WSL側のスキルを確認（`\\wsl.localhost\Ubuntu-22.04\home\shostako\.claude\skills\excel-vba-expert\`）
   - Windows側のスキル（`C:\Users\shost\.claude\skills\excel-vba-expert\SKILL.md`）をWindows用パスに修正
   - 保存先: `/home/shostako/...` → `C:\Users\shost\ClaudeCode\excel-auto\src\`
   - 変換コマンド: `./scripts/bas2sjis` → `.\scripts\bas2sjis.ps1`

2. **VBAマクロレビュー・修正（9モジュール）**
   - mCommon.bas - 問題なし、そのまま採用
   - m完成品フィルター.bas - 修正
   - m項目フィルター.bas - 修正
   - m項目削除.bas - 修正
   - m項目追加.bas - 修正
   - m小部品フィルター.bas - 修正
   - m側板フィルター.bas - 修正
   - m日付表示.bas - 修正
   - mフィルター解除.bas - 修正

### 共通の修正内容

- **元の設定を保存** → 元の値で復元（固定値Trueではなく）
- **Cleanupラベル追加** → 設定復元コードを一箇所に集約
- **FindTableByPatternのNothingチェック追加**
- **AutoFilterオブジェクトの存在チェック追加**
- **エラー情報の詳細化**（errNum, errDesc変数使用）

### 技術的な学び

- Git Bash環境でPowerShellスクリプトを実行: `powershell.exe -File script.ps1`
- Shift-JISファイルの読み込み: `iconv -f SHIFT-JIS -t UTF-8 "file.bas"`
- WSLファイルへのアクセス: `\\wsl.localhost\ディストリビューション名\...`

### 出力ファイル

```
src/ (UTF-8)
├── mCommon.bas
├── m完成品フィルター.bas
├── m項目フィルター.bas
├── m項目削除.bas
├── m項目追加.bas
├── m小部品フィルター.bas
├── m側板フィルター.bas
├── m日付表示.bas
└── mフィルター解除.bas

macros/ (Shift-JIS) - Excelインポート用
└── 同上9ファイル
```

---

## 2025-12-18 追加作業

### 実施内容

1. **プロジェクト名変更**
   - `excel-auto` → `excel-dev` に統一
   - CLAUDE.md、PROGRESS.md を修正

2. **Mondayエージェント設定**
   - 場所: `~/.claude/agents/monday.md`（ユーザーレベル設定）
   - 25歳のドライなITアシスタント、タメ口・皮肉を交えた対話スタイル
   - プロジェクト横断で有効

3. **Claude Code設定の更新**
   - `.claude/settings.json` - hooks設定を新フォーマットに移行
   - `.mcp.json` - playwright MCP設定にcmdラッパー追加（Windows対応）

### 備考

- Monday設定はgitリポジトリ外（ユーザーレベル）のため、コミット対象外
- GitHub連携を実施予定
