# Git/ワークフロー

## 基本方針

- **GitHub Actions使用停止**: Excelマクロ開発には複雑すぎるため
- **直接開発重視**: コード品質向上を最優先
- **文字エンコーディング管理**: UTF-8 ↔ Shift-JIS変換の確実な実行
- **手動クリーンアップ**: セッション終了時に実行

---

## マクロ開発フロー

1. **要件確認**
   - 入力元（シート名、テーブル名）
   - 出力先（シート名、テーブル名）
   - 処理内容の明確化

2. **コード生成**
   - `src/`ディレクトリに.basファイルとして保存
   - モジュール名を正しく設定

3. **必須変換**（毎回実行）
   ```powershell
   .\scripts\bas2sjis.ps1 src\マクロ名.bas
   ```
   - macrosフォルダにShift-JIS版が出力される
   - この手順を忘れるとExcelに取り込めない

4. **テスト方法**
   - ExcelのVBEでインポート
   - 実データでテスト実行

---

## Git管理手順

### 推奨コミットフロー

1. **開発**: `src/`でUTF-8ファイル編集
2. **変換**: bas2sjisで`macros/`に出力
3. **確認**: 変換結果とテスト
4. **コミット**: Git add → commit → push

### ファイル管理

- **追跡対象**: `src/`、`scripts/`、`docs/`
- **除外対象**: `macros/`（.gitignoreで除外推奨）
- **一時ファイル**: 自動削除される

---

## ワークスペース管理

### フォルダ役割

| フォルダ | 役割 | エンコード | 管理者 |
|---------|------|-----------|-------|
| inbox/ | ユーザー → Claude（参考マクロ） | Shift-JIS | ユーザー |
| src/ | Claudeの作業場（Git管理のマスター） | UTF-8 | Claude |
| macros/ | Claude → ユーザー（Excel取り込み用） | Shift-JIS | Claude |

### wrap時のクリーンアップ

**自動処理（確認なし）**:
- `inbox/*.bas` → 削除
- `macros/*.bas` → 削除
- `src/`の変更 → そのままコミット

**理由**:
- inbox/macrosは受け渡し用の一時フォルダ
- srcはClaudeが管理するマスターソース（ユーザー確認不要）
